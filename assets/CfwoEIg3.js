import{ci as w}from"./B8bEpPzb.js";import{B as Y}from"./DgrlDNDf.js";function K(t){for(var r=[],f=0;f<t.length;f++){var v=t[f];if(!v.defaultAttr.ignore){var d=v.label,o=d.getComputedTransform(),u=d.getBoundingRect(),O=!o||o[1]<1e-5&&o[2]<1e-5,p=d.style.margin||0,i=u.clone();i.applyTransform(o),i.x-=p/2,i.y-=p/2,i.width+=p,i.height+=p;var g=O?new w(u,o):null;r.push({label:d,labelLine:v.labelLine,rect:i,localRect:u,obb:g,priority:v.priority,defaultAttr:v.defaultAttr,layoutOption:v.computedLayoutOption,axisAligned:O,transform:o})}}return r}function X(t,r,f,v,d,o){var u=t.length;if(u<2)return;t.sort(function(a,y){return a.rect[r]-y.rect[r]});for(var O=0,p,i=!1,g=0;g<u;g++){var G=t[g],A=G.rect;p=A[r]-O,p<0&&(A[r]-=p,G.label[r]-=p,i=!0),O=A[r]+A[f]}var k=t[0],L=t[u-1],c,s;S(),c<0&&B(-c,.8),s<0&&B(s,.8),S(),E(c,s,1),E(s,c,-1),S(),c<0&&P(-c),s<0&&P(s);function S(){c=k.rect[r]-v,s=d-L.rect[r]-L.rect[f]}function E(a,y,h){if(a<0){var e=Math.min(y,-a);if(e>0){q(e*h,0,u);var n=e+a;n<0&&B(-n*h,1)}else B(-a*h,1)}}function q(a,y,h){a!==0&&(i=!0);for(var e=y;e<h;e++){var n=t[e],M=n.rect;M[r]+=a,n.label[r]+=a}}function B(a,y){for(var h=[],e=0,n=1;n<u;n++){var M=t[n-1].rect,z=Math.max(t[n].rect[r]-M[r]-M[f],0);h.push(z),e+=z}if(e){var W=Math.min(Math.abs(a)/e,y);if(a>0)for(var n=0;n<u-1;n++){var b=h[n]*W;q(b,0,n+1)}else for(var n=u-1;n>0;n--){var b=h[n-1]*W;q(-b,n,u)}}}function P(a){var y=a<0?-1:1;a=Math.abs(a);for(var h=Math.ceil(a/(u-1)),e=0;e<u-1;e++)if(y>0?q(h,0,e+1):q(-h,u-e-1,u),a-=h,a<=0)return}return i}function N(t,r,f,v){return X(t,"x","width",r,f)}function Q(t,r,f,v){return X(t,"y","height",r,f)}function U(t){var r=[];t.sort(function(c,s){return s.priority-c.priority});var f=new Y(0,0,0,0);function v(c){if(!c.ignore){var s=c.ensureState("emphasis");s.ignore==null&&(s.ignore=!1)}c.ignore=!0}for(var d=0;d<t.length;d++){var o=t[d],u=o.axisAligned,O=o.localRect,p=o.transform,i=o.label,g=o.labelLine;f.copy(o.rect),f.width-=.1,f.height-=.1,f.x+=.05,f.y+=.05;for(var G=o.obb,A=!1,k=0;k<r.length;k++){var L=r[k];if(f.intersect(L.rect)){if(u&&L.axisAligned){A=!0;break}if(L.obb||(L.obb=new w(L.localRect,L.transform)),G||(G=new w(O,p)),G.intersect(L.obb)){A=!0;break}}}A?(v(i),g&&v(g)):(i.attr("ignore",o.defaultAttr.ignore),g&&g.attr("ignore",o.defaultAttr.labelGuideIgnore),r.push(o))}}export{N as a,U as h,K as p,Q as s};
