import{aT as O,y as J,ag as _}from"./B8bEpPzb.js";import{ar as x,a0 as B,f as K,aT as Y,bm as z,b8 as V,N as W,P as X,bn as $,bo as E,aY as R}from"./DgrlDNDf.js";var G=Math.PI*2,I=X.CMD,N=["top","right","bottom","left"];function rr(e,n,o,r,v){var f=o.width,s=o.height;switch(e){case"top":r.set(o.x+f/2,o.y-n),v.set(0,-1);break;case"bottom":r.set(o.x+f/2,o.y+s+n),v.set(0,1);break;case"left":r.set(o.x-n,o.y+s/2),v.set(-1,0);break;case"right":r.set(o.x+f+n,o.y+s/2),v.set(1,0);break}}function ar(e,n,o,r,v,f,s,i,u){s-=e,i-=n;var h=Math.sqrt(s*s+i*i);s/=h,i/=h;var a=s*o+e,c=i*o+n;if(Math.abs(r-v)%G<1e-4)return u[0]=a,u[1]=c,h-o;if(f){var M=r;r=R(v),v=R(M)}else r=R(r),v=R(v);r>v&&(v+=G);var t=Math.atan2(i,s);if(t<0&&(t+=G),t>=r&&t<=v||t+G>=r&&t+G<=v)return u[0]=a,u[1]=c,h-o;var m=o*Math.cos(r)+e,b=o*Math.sin(r)+n,p=o*Math.cos(v)+e,S=o*Math.sin(v)+n,k=(m-s)*(m-s)+(b-i)*(b-i),w=(p-s)*(p-s)+(S-i)*(S-i);return k<w?(u[0]=m,u[1]=b,Math.sqrt(k)):(u[0]=p,u[1]=S,Math.sqrt(w))}function g(e,n,o,r,v,f,s,i){var u=v-e,h=f-n,a=o-e,c=r-n,M=Math.sqrt(a*a+c*c);a/=M,c/=M;var t=u*a+h*c,m=t/M;i&&(m=Math.min(Math.max(m,0),1)),m*=M;var b=s[0]=e+m*a,p=s[1]=n+m*c;return Math.sqrt((b-v)*(b-v)+(p-f)*(p-f))}function Q(e,n,o,r,v,f,s){o<0&&(e=e+o,o=-o),r<0&&(n=n+r,r=-r);var i=e+o,u=n+r,h=s[0]=Math.min(Math.max(v,e),i),a=s[1]=Math.min(Math.max(f,n),u);return Math.sqrt((h-v)*(h-v)+(a-f)*(a-f))}var C=[];function er(e,n,o){var r=Q(n.x,n.y,n.width,n.height,e.x,e.y,C);return o.set(C[0],C[1]),r}function vr(e,n,o){for(var r=0,v=0,f=0,s=0,i,u,h=1/0,a=n.data,c=e.x,M=e.y,t=0;t<a.length;){var m=a[t++];t===1&&(r=a[t],v=a[t+1],f=r,s=v);var b=h;switch(m){case I.M:f=a[t++],s=a[t++],r=f,v=s;break;case I.L:b=g(r,v,a[t],a[t+1],c,M,C,!0),r=a[t++],v=a[t++];break;case I.C:b=E(r,v,a[t++],a[t++],a[t++],a[t++],a[t],a[t+1],c,M,C),r=a[t++],v=a[t++];break;case I.Q:b=$(r,v,a[t++],a[t++],a[t],a[t+1],c,M,C),r=a[t++],v=a[t++];break;case I.A:var p=a[t++],S=a[t++],k=a[t++],w=a[t++],j=a[t++],A=a[t++];t+=1;var U=!!(1-a[t++]);i=Math.cos(j)*k+p,u=Math.sin(j)*w+S,t<=1&&(f=i,s=u);var Z=(c-p)*w/k+p;b=ar(p,S,w,j,j+A,U,Z,M,C),r=Math.cos(j+A)*k+p,v=Math.sin(j+A)*w+S;break;case I.R:f=r=a[t++],s=v=a[t++];var F=a[t++],H=a[t++];b=Q(f,s,F,H,c,M,C);break;case I.Z:b=g(r,v,f,s,c,M,C,!0),r=f,v=s;break}b<h&&(h=b,o.set(C[0],C[1]))}return h}var L=new x,y=new x,l=new x,d=new x,P=new x;function fr(e,n){if(e){var o=e.getTextGuideLine(),r=e.getTextContent();if(r&&o){var v=e.textGuideLineConfig||{},f=[[0,0],[0,0],[0,0]],s=v.candidates||N,i=r.getBoundingRect().clone();i.applyTransform(r.getComputedTransform());var u=1/0,h=v.anchor,a=e.getComputedTransform(),c=a&&V([],a),M=n.get("length2")||0;h&&l.copy(h);for(var t=0;t<s.length;t++){var m=s[t];rr(m,0,i,L,d),x.scaleAndAdd(y,L,d,M),y.transform(c);var b=e.getBoundingRect(),p=h?h.distance(y):e instanceof W?vr(y,e.path,l):er(y,b,l);p<u&&(u=p,y.transform(a),l.transform(a),l.toArray(f[0]),y.toArray(f[1]),L.toArray(f[2]))}or(f,n.get("minTurnAngle")),o.setShape({points:f})}}}var q=[],T=new x;function or(e,n){if(n<=180&&n>0){n=n/180*Math.PI,L.fromArray(e[0]),y.fromArray(e[1]),l.fromArray(e[2]),x.sub(d,L,y),x.sub(P,l,y);var o=d.len(),r=P.len();if(!(o<.001||r<.001)){d.scale(1/o),P.scale(1/r);var v=d.dot(P),f=Math.cos(n);if(f<v){var s=g(y.x,y.y,l.x,l.y,L.x,L.y,q,!1);T.fromArray(q),T.scaleAndAdd(P,s/Math.tan(Math.PI-n));var i=l.x!==y.x?(T.x-y.x)/(l.x-y.x):(T.y-y.y)/(l.y-y.y);if(isNaN(i))return;i<0?x.copy(T,y):i>1&&x.copy(T,l),T.toArray(e[1])}}}}function ir(e,n,o){if(o<=180&&o>0){o=o/180*Math.PI,L.fromArray(e[0]),y.fromArray(e[1]),l.fromArray(e[2]),x.sub(d,y,L),x.sub(P,l,y);var r=d.len(),v=P.len();if(!(r<.001||v<.001)){d.scale(1/r),P.scale(1/v);var f=d.dot(n),s=Math.cos(o);if(f<s){var i=g(y.x,y.y,l.x,l.y,L.x,L.y,q,!1);T.fromArray(q);var u=Math.PI/2,h=Math.acos(P.dot(n)),a=u+h-o;if(a>=u)x.copy(T,l);else{T.scaleAndAdd(P,i/Math.tan(Math.PI/2-a));var c=l.x!==y.x?(T.x-y.x)/(l.x-y.x):(T.y-y.y)/(l.y-y.y);if(isNaN(c))return;c<0?x.copy(T,y):c>1&&x.copy(T,l)}T.toArray(e[1])}}}}function D(e,n,o,r){var v=o==="normal",f=v?e:e.ensureState(o);f.ignore=n;var s=r.get("smooth");s&&s===!0&&(s=.3),f.shape=f.shape||{},s>0&&(f.shape.smooth=s);var i=r.getModel("lineStyle").getLineStyle();v?e.useStyle(i):f.style=i}function tr(e,n){var o=n.smooth,r=n.points;if(r)if(e.moveTo(r[0][0],r[0][1]),o>0&&r.length>=3){var v=Y(r[0],r[1]),f=Y(r[1],r[2]);if(!v||!f){e.lineTo(r[1][0],r[1][1]),e.lineTo(r[2][0],r[2][1]);return}var s=Math.min(v,f)*o,i=z([],r[1],r[0],s/v),u=z([],r[1],r[2],s/f),h=z([],i,u,.5);e.bezierCurveTo(i[0],i[1],i[0],i[1],h[0],h[1]),e.bezierCurveTo(u[0],u[1],u[0],u[1],r[2][0],r[2][1])}else for(var a=1;a<r.length;a++)e.lineTo(r[a][0],r[a][1])}function hr(e,n,o){var r=e.getTextGuideLine(),v=e.getTextContent();if(!v){r&&e.removeTextGuideLine();return}for(var f=n.normal,s=f.get("show"),i=v.ignore,u=0;u<O.length;u++){var h=O[u],a=n[h],c=h==="normal";if(a){var M=a.get("show"),t=c?i:B(v.states[h]&&v.states[h].ignore,i);if(t||!B(M,s)){var m=c?r:r&&r.states[h];m&&(m.ignore=!0),r&&D(r,!0,h,a);continue}r||(r=new J,e.setTextGuideLine(r),!c&&(i||!s)&&D(r,!0,"normal",n.normal),e.stateProxy&&(r.stateProxy=e.stateProxy)),D(r,!1,h,a)}}if(r){K(r.style,o),r.style.fill=null;var b=f.get("showAbove"),p=e.textGuideLineConfig=e.textGuideLineConfig||{};p.showAbove=b||!1,r.buildPath=tr}}function ur(e,n){n=n||"labelLine";for(var o={normal:e.getModel(n)},r=0;r<_.length;r++){var v=_[r];o[v]=e.getModel([v,n])}return o}export{ir as a,ur as g,or as l,hr as s,fr as u};
